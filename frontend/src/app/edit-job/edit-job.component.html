<form class="needs-validation" #userForm="ngForm" (ngSubmit)="userForm.form.valid && onSubmit(userForm)">
    <div class="row">
      <div class="col-12">
        <div class="content-header">Edit Job</div>
      </div>
    </div>
  
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Client Information</h4>
          </div>
          <div class="card-content">
            <div class="card-body">
  
              <div class="form-row">
                <div class="col-md-4 mb-4 form-group">
                  <label for="validationTooltip01">First name</label>
                  <input type="text" name="fname" class="form-control" id="validationTooltip01" placeholder="First name"
                    [(ngModel)]="model.fname" #fname="ngModel"
                    [ngClass]="{ 'is-invalid': userForm.submitted && fname.invalid, 'is-valid': userForm.submitted &&  !fname.invalid }"
                    required>
                  <div *ngIf="userForm.submitted && !fname.errors?.required" class="valid-tooltip">Looks good!</div>
                </div>
                <div class="col-md-4 mb-4 form-group">
                  <label for="validationTooltip02">Last name</label>
                  <input type="text" name="lname" class="form-control" id="validationTooltip02" placeholder="Last name"
                    [(ngModel)]="model.lname" #lname="ngModel"
                    [ngClass]="{ 'is-invalid': userForm.submitted && lname.invalid, 'is-valid': userForm.submitted && !lname.invalid }"
                    required>
                  <div *ngIf="userForm.submitted && !lname.errors?.required" class="valid-tooltip">Looks good!</div>
                </div>
                <div class="col-md-4 mb-4 form-group">
                  <label for="validationTooltip03">Phone Number</label>
                  <input type="text" name="phone" class="form-control" id="validationTooltip03" placeholder="Phone Number"
                    [(ngModel)]="model.phone" #phone="ngModel"
                    [ngClass]="{ 'is-invalid': userForm.submitted && phone.invalid, 'is-valid': userForm.submitted && !phone.invalid }"
                    required>
                  <div *ngIf="userForm.submitted && (phone.invalid || phone.errors?.required)" class="invalid-tooltip">
                    Please provide a valid Phone Number.</div>
                </div>
              </div>
  
            </div>
          </div>
        </div>
      </div>
    </div>
  
<div class="row">
      <div class="col-sm-12 col-md-12 col-lg-8">
        <!-- Kick start -->
        <div id="kick-start" class="card">
          <div class="card-header">
            <h4 class="card-title">Job Informaton</h4>
          </div>
          <div class="card-content">
            <div class="card-body">
              <div class="card-text">

                  <div class="mb-4 form-group">
                    <!-- <label for="carInfo">Car Info</label> -->
                    <textarea class="form-control" aria-label="With textarea" name="carInfo" class="form-control" id="carInfo" placeholder="Car Info"
                    [(ngModel)]="model.carInfo" #carInfo="ngModel"
                    [ngClass]="{ 'is-invalid': userForm.submitted && carInfo.invalid, 'is-valid': userForm.submitted &&  !carInfo.invalid }"
                    required></textarea>
                    <div *ngIf="userForm.submitted && !carInfo.errors?.required" class="valid-tooltip">Looks good!</div>
                  </div>
                  <div class="mb-4 form-group">
                    <div class="form-row">
                      <div class="form-group col-sm-12 col-md-12 col-lg-6">
                          <label>Primary Color:</label>
                          <input class="form-control" type="color" name="primary-color" [(ngModel)]="model.primary">
                      </div>
                      <div class="form-group col-sm-12 col-md-12 col-lg-6">
                          <label>Secondary Color:</label>
                          <input class="form-control" type="color" name="secondary-color" [(ngModel)]="model.secondary">
                      </div>
                    </div>
                    <div class="form-row">
                      <div class="form-group col-sm-12 col-md-12 col-lg-6 pl-4">
                          <label>Starts At:</label><br>
                          <!-- code here -->
                          <!-- <input [owlDateTimeTrigger]="db" [owlDateTime]="db" [(ngModel)]="startDate" name="startDate">
                          <owl-date-time [startAt]="startDate" #db></owl-date-time> -->
                          <owl-date-time-inline [(ngModel)]="startDate" [startAt]="startDate" name="startDate"></owl-date-time-inline>

                      </div>
                      <div class="form-group col-sm-12 col-md-12 col-lg-6 pl-4">
                          <label>Ends At:</label><br>
                          <!-- code here -->
                          <owl-date-time-inline [(ngModel)]="endDate" [startAt]="endDate" name="endDate"></owl-date-time-inline>
                          <!-- <input [owlDateTimeTrigger]="dt" [owlDateTime]="dt" [(ngModel)]="endDate" name="endDate">
                          <owl-date-time [startAt]="endDate" #dt></owl-date-time> -->
                        </div>
                    </div>
                  </div>

              </div>
            </div>
          </div>
        </div>
        <!--/ Kick start -->
      </div>
  
      <div class="col-sm-12 col-md-12 col-lg-4">
        <!-- Kick start -->
        <div id="kick-start" class="card">
          <div class="card-header">
            <h4 class="card-title">Notes</h4>
          </div>
          <div class="card-content">
            <div class="card-body">
              <textarea class="form-control notes" rows="29" style="height:100%;" aria-label="With textarea" name="notes" class="form-control" id="notes" placeholder="Notes"
              [(ngModel)]="model.notes" #notes="ngModel"
              [ngClass]="{ 'is-invalid': userForm.submitted && notes.invalid, 'is-valid': userForm.submitted &&  !notes.invalid }"
              required></textarea>
              <div *ngIf="userForm.submitted && !notes.errors?.required" class="valid-tooltip">Looks good!</div>
            </div>
          </div>
        </div>
        <!--/ Kick start -->
      </div>
    </div>
  
    <div class="row" *ngIf="notClosed; else closed">
      <div class="col">
        <button class="btn btn-danger btn-block btn-lg" (click)="delete()">Delete</button>
      </div>
      <div class="col">
        <button class="btn btn-primary btn-block btn-lg" type="submit">Save</button>
      </div>
      <div class="col">
        <button class="btn btn-success btn-block btn-lg" (click)="sendToTintWork()">Send to TintWork</button>
      </div>
    </div>

    <ng-template #closed>
      <div class="row">
        <div class="col">
          <button class="btn btn-danger btn-block btn-lg" [routerLink]="'/jobs'">Back</button>
        </div>
      </div>
    </ng-template>
  
  </form>

<h2 class="text-center py-4">Job History</h2>
<!--Vertical Timeline Starts-->
<section id="vertical-timeline-center" class="timeline-center timeline-wrapper col-sm-10 col-12 offset-sm-1">
  <ul class="timeline">
    <li class="timeline-line mt-4"></li>
      <li class="timeline-group">
        <h5><span class="badge badge-primary cursor-default">Start</span></h5>
      </li>
  </ul>

  <ul class="timeline">
    <li class="timeline-line"></li>
    <ng-container *ngFor="let change of history">
      <ng-container *ngIf="change.placement == 'right'">
        <li class="timeline-item">
          <div class="timeline-badge">
            <span class="bg-primary bg-lighten-4" data-toggle="tooltip" placement="right" ngbTooltip="Nullam facilisis fermentum">
              <i class="ft-command primary"></i>
            </span>
          </div>
          <div class="timeline-card card shadow-z-1">
            <div class="card-content">
              <div class="card-body">
                <h4 class="card-title mb-0">{{ change.editor }}</h4>
                <div class="card-subtitle text-muted mt-0">
                  <span class="font-small-3">{{ change.timestamp }}</span>
                </div>
                <hr class="mt-0 mb-2">
                <div *ngFor="let event of change.changes | keyvalue">
                  <ng-container *ngIf="change.event_type == 'Created'">
                    <p class="m-0 mb-1 font-medium-1">
                      The field <span class="text-bold-600">{{event.key}}</span> was created with <span class="text-primary">{{ event.value.new }}</span> value.
                    </p>
                  </ng-container>
                  <ng-container *ngIf="change.event_type == 'Edited'">
                    <p class="m-0 mb-1 font-medium-1">
                      The field <span class="text-bold-600">{{event.key}}</span> changed from <span class="text-warning">{{ event.value.old }}</span> to <span class="text-primary">{{ event.value.new }}</span>
                    </p>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ng-container>
      <ng-container *ngIf="change.placement == 'left'">
        <li class="timeline-item mt-5">
          <div class="timeline-badge">
            <span class="bg-primary bg-lighten-4" data-toggle="tooltip" placement="left" ngbTooltip="Nullam facilisis fermentum">
              <i class="ft-command primary"></i>
            </span>
          </div>
          <div class="timeline-card card shadow-z-1">
            <div class="card-content">
              <div class="card-body">
                <h4 class="card-title mb-0">{{ change.editor }}</h4>
                <div class="card-subtitle text-muted mt-0">
                  <span class="font-small-3">{{ change.timestamp }}</span>
                </div>
                <hr class="mt-0 mb-2">
                <div *ngFor="let event of change.changes | keyvalue">
                  <ng-container *ngIf="change.event_type == 'Created'">
                    <p class="m-0 mb-1 font-medium-1">
                      The field <span class="text-bold-600">{{event.key}}</span> was created with <span class="text-primary">{{ event.value.new }}</span> value.
                    </p>
                  </ng-container>
                  <ng-container *ngIf="change.event_type == 'Edited'">
                    <p class="m-0 mb-1 font-medium-1">
                      The field <span class="text-bold-600">{{event.key}}</span> changed from <span class="text-warning">{{ event.value.old }}</span> to <span class="text-primary">{{ event.value.new }}</span>
                    </p>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ng-container>
    </ng-container>
  </ul>
  <ul class="timeline">
    <li class="timeline-line mb-4"></li>
    <li class="timeline-group">
      <h5><span class="badge badge-primary cursor-default">Today</span></h5>
    </li>
  </ul>
</section>
<!--Vertical Timeline Ends-->
